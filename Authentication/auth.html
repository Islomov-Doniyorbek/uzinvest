<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/Authentication/auth.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Avtorizatsiya</title>
</head>
<body>
    
    <div class="container">
        <div class="col left">
            <img src="/Pictures/2reg-gigapixel-art-scale-2_00x.jpg" alt="">
        </div>
        <div class="col">
            <div class="wrap">
                <form action="#" method="GET" id="formReg">
                    <div class="title">
                        <h2>Registratsiya</h2>
                        <p>Ro'yxatdan o'tish uchun quyidagi formani to'ldiring</p>
                     </div>
                     <div class="inputs">
                        <p>
                            <i class="fa fa-user"></i>
                            <input type="text" id="checking" class="ism" pattern="[a-z, A-Z]{2-15}" minlength="3" placeholder="Ism" required>
                        </p>
                        <p>
                            <i class="fa fa-user"></i>
                            <input type="text" id="checking" class="username" pattern="[a-z, A-Z]{2-15}" minlength="6" placeholder="UserName" required>
                        </p>
                        <p>
                            <i class="fa fa-id-card"></i>
                            <select name="mijoz" id="mijoz" required>
                                <option value=""></option>
                                <option value="Tadbirkor">Tadbirkor</option>
                                <option value="Investor">Investor</option>
                            </select>
                        </p>
                        <p>
                            <i class="fa fa-phone"></i>
                            <input type="tel" pattern="[0-9]{2}-[0-9]{3}-[0-9]{2}-[0-9]{2}" placeholder="xx-xxx-xx-xx" class="tel" id="checking" required>
                        </p>
                        <p>
                            <i class="fa fa-lock"></i>
                            <input type="password" id="checking" maxlength="8" pattern="[a-z, 0-9]{5,8}" placeholder="xxxxx" class="parol" required>
                        </p>
                        <span>parol uzunlligi 8 ta belgidan kam bo'lmasligi lozim</span>
                        <b id="checked"><input type="checkbox" name="" id="checkboxing"> Ro'yxatdan o'tish uchun barcha shartlarga roziman</b>
                     </div>
                     <p class="logHave">
                        Hisobingiz bormi?! <a href="" id="link">Kirish</a>
                    </p>                     
                     <button id="registr">Registratsiya</button>
                </form>
                <form action="#" method="get" id="formLog">
                    <div class="title">
                        <h2>Kirish</h2>
                        <p>Kirish uchun quyidagi formani to'ldiring</p>
                     </div>
                     <div class="inputs">
                        <p>
                            <i class="fa fa-envelope"></i>
                            <input type="text" class="logUser" id="checking" placeholder="username" required>
                        </p>
                        <p>
                            <i class="fa fa-lock"></i>
                            <input type="password" id="checking" class="logPass" maxlength="8" pattern="[a-z, 0-9]{5,8}" placeholder="Password" required>
                        </p>
                        <span>parol uzunlligi 8 ta belgidan kam bo'lmasligi lozim</span>
                        <a href="#" id="zabil">Parolni unutdingizmi?!</a>
                        <b id="checked"><input type="checkbox" name="" id="checkboxing"> Kirish uchun barcha shartlarga roziman</b>
                     </div>
                     <p class="DontLog">
                        Hisobingiz yo'qmi?! <a href="sms:+9" id="link">Ro'yxatdan o'tish</a>
                    </p>
                     <button id="kirish">Kirish</button>
                </form>
                <form action="#" method="get" id="formZabil">
                    <div class="title">
                        <h2>Parolingizni unutdingizmi?!</h2>
                        <p>Sizga 4 xonali son yuborishimiz uchun telefon raqamingizni kiriting</p>
                     </div>
                     <div class="inputs">
                        <p>
                            <i class="fa fa-phone"></i>+998
                            <input type="tel" pattern="[0-9]{2}-[0-9]{3}-[0-9]{2}-[0-9]{2}" placeholder="xx-xxx-xx-xx" id="checking" required>
                        </p>
                        <button id="sendCodePhone">Yuborish</button>
                     </div>
                </form>
                <form action="#" method="get" id="formSMS">
                    <div class="title">
                        <h2>SMS kodni kiriting</h2>
                        <p>Sizning raqamingizga 4 xonali son yuborildi: <b class="tel" style="color: black; font-weight:800;">+998885784120</b></p>
                     </div>
                     <div class="inputs code">
                        <input type="text" pattern="[0-9]{1}" required>
                        <input type="text" pattern="[0-9]{1}" required>
                        <input type="text" pattern="[0-9]{1}" required>
                        <input type="text" pattern="[0-9]{1}" required>                       
                     </div>
                     <p class="config">
                        <b class="time"><i class="fa fa-hourglass-1"></i> <b class="times"></b></b> <strong>Kod kelmadimi? <a href="#" id="resend">Qayta yuborish</a></strong> 
                     </p>
                     <button id="sendCode">Yuborish</button>  
                </form>
                <form action="#" method="get" id="formNewPass">
                    <div class="title">
                        <h2>Yangi parol yaratish</h2>
                        <p>Yangi parolingizni yarating</p>
                     </div>
                     <div class="inputs">
                        <p>
                            <i class="fa fa-lock"></i>
                            <input type="password" id="checking" maxlength="8" pattern="[a-z, 0-9]{5,8}" placeholder="Yangi parol" required>
                        </p>                   
                        <p>
                            <i class="fa fa-lock"></i>
                            <input type="password" id="checking" maxlength="8" pattern="[a-z, 0-9]{5,8}" placeholder="Tasdiqlash" required>
                        </p>                   
                        <span>parol uzunlligi 8 ta belgidan kam bo'lmasligi lozim</span>
                     </div>
                     <button id="sendNewPassword">Yuborish</button>
                </form>
            </div>
        </div>
    </div>

    <script src="/Authentication/auth.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-analytics.js";
        import { getDatabase, ref, set, get,child, update, onValue, orderByChild} from "https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyAGpBTT8n5qJN2DLg0Yij3WddmzUbwVDho",
          authDomain: "uzinvest-eac73.firebaseapp.com",
          projectId: "uzinvest-eac73",
          storageBucket: "uzinvest-eac73.appspot.com",
          messagingSenderId: "934360038099",
          appId: "1:934360038099:web:d24940c15e17a09db0b226",
          measurementId: "G-2CVZMJN98T"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        let db = getDatabase(app)

        let formReg = document.querySelector("#registr");
        let formLog = document.querySelector("#kirish");
        const dbrf = ref(db);

        formReg.addEventListener("click", (e)=>{
            e.preventDefault();
            
            set(ref(db, 'user/' + document.querySelector(".username").value), {
                username: document.querySelector(".ism").value,
                nickname: document.querySelector('.username').value,
                type: document.querySelector('#mijoz').value,
                phone: document.querySelector('.tel').value,
                password: document.querySelector('.parol').value,
                birth: "",
                address: "",
                familiya: ""
            });
            get(child(dbrf, 'user')).then((snap)=>{
                localStorage.setItem("nick", snap.val()[document.querySelector(".username").value].nickname);
            })
            alert("Muvaffaqiyatli ro'yxatdan o'tdingiz!!!");
        })
        formLog.addEventListener("click", (e)=>{
            e.preventDefault()
            get(child(dbrf, 'user')).then((snapshot)=>{
                if(snapshot.val()[document.querySelector(".logUser").value] && snapshot.val()[document.querySelector(".logUser").value].password == document.querySelector(".logPass").value){
                    window.location.href = "/index.html";
                }
            })
            alert("Success")
        })

        
      </script>
</body>
</html>